---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by root.
--- DateTime: 8/6/19 9:30 AM
---

local BasePlugin = require("kong.plugins.base_plugin")


local MyHanlder = BasePlugin:extend()

local log = kong.log
local strPrefix = "===========> config: "
local requestPrint = "===========> req: "

MyHanlder.VERSION = "1.0.0"
MyHanlder.PRIORITY = 14

function MyHanlder:new()
    MyHanlder.super.new(self, "test")
end

function MyHanlder:access(conf)
    MyHanlder.super.access(self)

    local headers = kong.request.get_headers()
    
    ngx.log(ngx.DEBUG ,"access executed...")
    ngx.log(ngx.DEBUG ,requestPrint.."method="..kong.request.get_method())

    ngx.log(ngx.DEBUG ,"headers length = "..table.getn(headers))

    for i, v in ipairs(headers) do
        ngx.log(ngx.DEBUG ,requestPrint.."headerName="..i.." / headerValue="..v)
    end


    if conf.intercepter then
        ngx.log(ngx.DEBUG ,"================> 拦截他  <===============")

    else
        ngx.log(ngx.DEBUG ,"================> do not intecepter  <===============")
    end

    --ngx.log(ngx.DEBUG ,requestPrint.."key="..conf.key)
end

return MyHanlder



