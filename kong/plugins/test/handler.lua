---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by root.
--- DateTime: 8/6/19 9:30 AM
---

local BasePlugin = require("kong.plugins.base_plugin")


local MyHanlder = BasePlugin:extend()

local log = kong.log
local strPrefix = "===========> config: "
local requestPrint = "===========> req: "

MyHanlder.VERSION = "1.0.0"
MyHanlder.PRIORITY = 14

function MyHanlder.printLog(content)
    ngx.log(ngx.DEBUG , content)
end

function MyHanlder:new()
    MyHanlder.super.new(self, "test")
end

function MyHanlder:access(conf)
    MyHanlder.super.access(self)

    local headers = kong.request.get_headers()
    
    MyHanlder.printLog("access executed...")
    MyHanlder.printLog(requestPrint.."method="..kong.request.get_method())

    MyHanlder.printLog("headers length = "..table.getn(headers))

    for i, v in ipairs(headers) do
        MyHanlder.printLog(requestPrint.."headerName="..i.." / headerValue="..v)
    end


    if conf.intercepter then
        MyHanlder.printLog("================> 拦截他  <===============")

    else
        MyHanlder.printLog("================> do not intecepter  <===============")
    end

    --MyHanlder.printLog(requestPrint.."key="..conf.key)
end

return MyHanlder



